---
title: Analysis of the James Bond Dataset
author: Jon Cockayne
format: 
    html: default
    pdf: default
editor: 
  markdown: 
    wrap: sentence
---

In this document we will investigate the James Bond dataset from [Kaggle](https://www.kaggle.com/datasets/dreb87/jamesbond).
In [@sec-initial] we will determine which film made the most money.
In [@sec-earnings] we will check whether movie earnings and budget are correlated, when adjusted for inflation.
Finally in [@sec-fun] we will investigate the correlation between movie earnings and how often Bond says "Bond, James Bond".

## Most Profitable Movie {#sec-initial}

```{r}
#| message: false
#| echo: false
#| include: false
library(tidyverse)
bond.data <- read_csv("data/jamesbond.csv")
bond.data
```

Which movie made the most money?

```{r}
by_profit <- bond.data |>
    select(Year, Movie, US_Gross) |>
    arrange(desc(US_Gross))
by_profit
```

The most profitable movie was `r by_profit$Movie[1]`, made in `r by_profit$Year[1]`.
It made a profit of $`r sprintf("%.0f", by_profit$US_Gross[1])`.

## Correlation of Earnings {#sec-earnings}

Next we investigate whether there is a significant relationship between the budget of the film and the earnings in the US.

```{r}
ggplot(bond.data, aes(x=Budget, y=US_Gross)) +
    geom_point()
```

It looks as though there is, but this doesn't account for inflation; let's dig deeper by adding a colour based on the year.

```{r}
ggplot(bond.data, aes(x=Budget, y=US_Gross, color=Year)) +
    geom_point() +
    scale_color_continuous()
```

From this it is obvious that the newer films both cost more and earn more money.
This is therefore likely due to inflation.
Fortunately the dataset also provides budgets adjusted for inflation.

```{r}
bond.data |> ggplot(aes(x=Budget_Adj, y=US_Adj, color=Year)) +
    geom_point() +
    scale_color_continuous()
```

It still seems that the budget has been increasing with year, however there is a much less obvious correlation between this and the earnings of the movie.

## Just for Fun {#sec-fun}

Lastly let's investigate whether there is a correlation between the earnings of the movie and the number of times James Bond says "Bond, James Bond".

```{r}
bond.data |> ggplot(aes(x=BJB, y=US_Adj)) +
    geom_point() +
    scale_color_continuous()
```

It looks as though there is a nonlinear relationship between the variables; movies are more likely to earn more money if Bond says "Bond, James Bond" either 0 or 2 times.

Adding a plot of Martini against US_ADj.

```{r}
bond.data |> ggplot(aes(x = Martinis, y = US_Adj)) +
  geom_point() +
  scale_color_continuous()
```


```{r}
bond.data |> ggplot(aes(x = Avg_User_Rtn_Tom, y = US_Adj)) +
  geom_point() +
  scale_color_continuous()
```
